# üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç - Docker + Azure Container Apps

## üìã –ó–∞–≤–¥–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏

1. ‚úÖ –°—Ç–≤–æ—Ä–∏—Ç–∏ Docker –æ–±—Ä–∞–∑–∏ –¥–ª—è REST —Å–µ—Ä–≤—ñ—Å—É
2. ‚úÖ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –Ω–∞ Azure
3. ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è
4. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ–π –≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
5. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç —ñ –≤—ñ–¥—Å–ª—ñ–¥–∫—É–≤–∞—Ç–∏ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

---

## üèÉ –®–≤–∏–¥–∫–µ –ª–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### 1. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
# –ó–∞–ø—É—Å–∫ Flask API + MySQL
docker-compose up -d

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞
curl http://localhost:5000/api/docs/
```

### 2. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –ü—Ä–æ—Å—Ç–∏–π —Å–ø–æ—Å—ñ–±
./run_load_test.sh http://localhost:5000 10 60

# –ê–±–æ –¥–µ—Ç–∞–ª—å–Ω–∏–π Python —Å–∫—Ä–∏–ø—Ç
python3 load_test.py --url http://localhost:5000 --threads 10 --duration 60
```

---

## ‚òÅÔ∏è –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ Azure

### 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
# –í—Ö—ñ–¥ –≤ Azure
az login

# –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Docker (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
# macOS: brew install docker
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `azure-deploy.sh`:

```bash
# –ó–º—ñ–Ω—ñ—Ç—å —Ü—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
RESOURCE_GROUP="db-repo-rg"
ACR_NAME="dbreporegistry"          # –ú–∞—î –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º!
CONTAINER_APP_NAME="db-repo-app"

# –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î
DB_HOST="your-server.mysql.database.azure.com"
DB_USER="adminuser"
DB_PASSWORD="YourPassword123!"
```

### 3. –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

```bash
chmod +x azure-deploy.sh
./azure-deploy.sh
```

–û—á—ñ–∫—É–π—Ç–µ 10-15 —Ö–≤–∏–ª–∏–Ω –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è.

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

### 1. –û—Ç—Ä–∏–º–∞–π—Ç–µ URL –≤–∞—à–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É

–ü—ñ—Å–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç –≤–∏–≤–µ–¥–µ URL, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
```
https://db-repo-app.nicecoast-xxxxx.westeurope.azurecontainerapps.io
```

–ê–±–æ –∑–Ω–∞–π–¥—ñ—Ç—å –π–æ–≥–æ:
```bash
az containerapp show \
  --name db-repo-app \
  --resource-group db-repo-rg \
  --query properties.configuration.ingress.fqdn -o tsv
```

### 2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

```bash
# –õ–µ–≥–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (10 –ø–æ—Ç–æ–∫—ñ–≤, 5 —Ö–≤–∏–ª–∏–Ω)
python3 load_test.py --url https://YOUR-APP-URL --threads 10 --duration 300

# –°–µ—Ä–µ–¥–Ω—î –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (30 –ø–æ—Ç–æ–∫—ñ–≤, 10 —Ö–≤–∏–ª–∏–Ω)
python3 load_test.py --url https://YOUR-APP-URL --threads 30 --duration 600

# –í–∞–∂–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (50 –ø–æ—Ç–æ–∫—ñ–≤, 15 —Ö–≤–∏–ª–∏–Ω)
python3 load_test.py --url https://YOUR-APP-URL --threads 50 --duration 900
```

### 3. –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

**–í —ñ–Ω—à–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥:**

```bash
# –ü–µ—Ä–µ–≥–ª—è–¥ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ä–µ–ø–ª—ñ–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
watch -n 5 'az containerapp replica list \
  --name db-repo-app \
  --resource-group db-repo-rg \
  --query "[].name" -o table'
```

**–ê–±–æ —á–µ—Ä–µ–∑ Azure Portal:**
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ https://portal.azure.com
2. –ó–Ω–∞–π–¥—ñ—Ç—å Resource Group: `db-repo-rg`
3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Container App: `db-repo-app`
4. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –≤ **Metrics** ‚Üí –≤–∏–±–µ—Ä—ñ—Ç—å **Replica Count**
5. –î–æ–¥–∞–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ **CPU Usage** —Ç–∞ **Memory Usage**

### 4. –©–æ –æ—á—ñ–∫—É–≤–∞—Ç–∏

| –ß–∞—Å        | –†–µ–ø–ª—ñ–∫–∏ | CPU    | –û–ø–∏—Å                          |
|------------|---------|--------|-------------------------------|
| 0-2 —Ö–≤     | 1       | 20-40% | –ü–æ—á–∞—Ç–∫–æ–≤–∞ —Ñ–∞–∑–∞                |
| 2-5 —Ö–≤     | 1-3     | 70%+   | –ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑—Ä–æ—Å—Ç–∞—î          |
| 5-10 —Ö–≤    | 3-8     | 60-80% | –ê–≤—Ç–æ–º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–µ     |
| 10-15 —Ö–≤   | 5-10    | 50-70% | –°—Ç–∞–±—ñ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞              |
| –ü—ñ—Å–ª—è —Ç–µ—Å—Ç—É| 10‚Üí1    | ‚Üì      | –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –≤–Ω–∏–∑ (2-5 —Ö–≤)   |

---

## üìä –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤ —Ç–∞ –º–µ—Ç—Ä–∏–∫

### –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

```bash
az containerapp logs show \
  --name db-repo-app \
  --resource-group db-repo-rg \
  --follow
```

### –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ä–µ–ø–ª—ñ–∫

```bash
az containerapp replica list \
  --name db-repo-app \
  --resource-group db-repo-rg \
  --output table
```

### –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

```bash
az containerapp show \
  --name db-repo-app \
  --resource-group db-repo-rg \
  --query "properties.template.scale"
```

---

## üéØ –ö—Ä–∏—Ç–µ—Ä—ñ—ó —É—Å–ø—ñ—à–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

- [x] Docker –æ–±—Ä–∞–∑ —Å—Ç–≤–æ—Ä–µ–Ω–æ —Ç–∞ –ø—Ä–∞—Ü—é—î –ª–æ–∫–∞–ª—å–Ω–æ
- [x] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –Ω–∞ Azure Container Registry
- [x] Container App —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ –∑ –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è–º
- [x] –ü—Ä–∞–≤–∏–ª–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è: CPU > 70%, Memory > 80%
- [x] –ú—ñ–Ω—ñ–º—É–º 1, –º–∞–∫—Å–∏–º—É–º 10 —Ä–µ–ø–ª—ñ–∫
- [x] –°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—î
- [ ] –ó–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –≤–≥–æ—Ä—É (1 ‚Üí 5-10 —Ä–µ–ø–ª—ñ–∫)
- [ ] –ó–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –≤–Ω–∏–∑ (10 ‚Üí 1 —Ä–µ–ø–ª—ñ–∫–∞)
- [ ] –ó–±–µ—Ä–µ–∂–µ–Ω–æ —Å–∫—Ä—ñ–Ω—à–æ—Ç–∏ –º–µ—Ç—Ä–∏–∫ –∑ Azure Portal
- [ ] –ó–±–µ—Ä–µ–∂–µ–Ω–æ –ª–æ–≥–∏ –ø–æ–¥—ñ–π –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

---

## üì∏ –©–æ –∑–∞—Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ –¥–ª—è –∑–≤—ñ—Ç—É

1. **–°–∫—Ä—ñ–Ω—à–æ—Ç–∏ Azure Portal:**
   - –ú–µ—Ç—Ä–∏–∫–∏: Replica Count, CPU Usage, Memory Usage
   - –õ–æ–≥–∏: Events –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è
   - Container Apps: –°–ø–∏—Å–æ–∫ —Ä–µ–ø–ª—ñ–∫ –ø—ñ–¥ —á–∞—Å –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

2. **–í–∏–≤—ñ–¥ –∫–æ–Ω—Å–æ–ª—ñ:**
   - –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ `load_test.py`
   - –í–∏–≤—ñ–¥ –∫–æ–º–∞–Ω–¥–∏ `az containerapp replica list`
   - –õ–æ–≥–∏ `az containerapp logs show`

3. **–§–∞–π–ª–∏:**
   - `load_test_results_*.txt` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è)
   - –°–∫—Ä—ñ–Ω—à–æ—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –∑ Azure Portal

---

## üßπ –û—á–∏—â–µ–Ω–Ω—è –ø—ñ—Å–ª—è —Ä–æ–±–æ—Ç–∏

```bash
# –í–∏–¥–∞–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ Azure
az group delete --name db-repo-rg --yes --no-wait

# –û—á–∏—â–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ Docker
docker-compose down -v
docker system prune -a
```

‚ö†Ô∏è **–£–≤–∞–≥–∞:** –í–∏–¥–∞–ª–µ–Ω–Ω—è Resource Group –≤–∏–¥–∞–ª–∏—Ç—å –í–°–Ü —Ä–µ—Å—É—Ä—Å–∏ –≤ –Ω—å–æ–º—É!

---

## üìñ –î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –¥–∏–≤—ñ—Ç—å—Å—è:
- **[DOCKER_AZURE_GUIDE.md](./DOCKER_AZURE_GUIDE.md)** - –ø–æ–≤–Ω–∏–π –ø–æ—Å—ñ–±–Ω–∏–∫

---

## üí° –ü—ñ–¥–∫–∞–∑–∫–∏

### –Ø–∫—â–æ Container App –Ω–µ –º–∞—Å—à—Ç–∞–±—É—î—Ç—å—Å—è:

1. –ó–±—ñ–ª—å—à—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤: `--threads 50`
2. –ó–±—ñ–ª—å—à—Ç–µ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: `--duration 900`
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ CPU –≤ Azure Portal
4. –ú–æ–∂–ª–∏–≤–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–Ω–∏–∑–∏—Ç–∏ –ø–æ—Ä—ñ–≥ CPU:
   ```bash
   az containerapp update \
     --name db-repo-app \
     --resource-group db-repo-rg \
     --scale-rule-metadata type=Utilization value=50
   ```

### –Ø–∫—â–æ —à–≤–∏–¥–∫—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∏–∑—å–∫–∞:

1. –ó–±—ñ–ª—å—à—Ç–µ —Ä–µ—Å—É—Ä—Å–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
   ```bash
   az containerapp update \
     --name db-repo-app \
     --resource-group db-repo-rg \
     --cpu 1.0 \
     --memory 2.0Gi
   ```

2. –ó–±—ñ–ª—å—à—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å workers —É Gunicorn (–∑–º—ñ–Ω—ñ—Ç—å Dockerfile):
   ```dockerfile
   CMD ["gunicorn", "--bind", "0.0.0.0:5000", "--workers", "8", "app:app"]
   ```

---

## üìû –î–æ–ø–æ–º–æ–≥–∞

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏: `az containerapp logs show ...`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å: `az containerapp show ...`
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ë–î –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
4. –î–∏–≤—ñ—Ç—å—Å—è —Ä–æ–∑–¥—ñ–ª Troubleshooting —É DOCKER_AZURE_GUIDE.md

---

**–£—Å–ø—ñ—Ö—ñ–≤ —É –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏! üöÄ**

